<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Simulation and Estimation Diagnostics · PuMaS</title><link href="https://cdnjs.cloudflare.com/ajax/libs/normalize/4.2.0/normalize.min.css" rel="stylesheet" type="text/css"/><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.2.0/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link href="../../assets/documenter.css" rel="stylesheet" type="text/css"/></head><body><nav class="toc"><h1>PuMaS</h1><select id="version-selector" onChange="window.location.href=this.value" style="visibility: hidden"></select><form class="search" id="search-form" action="../../search/"><input id="search-query" name="q" type="text" placeholder="Search docs"/></form><ul><li><a class="toctext" href="../../">Home</a></li><li><span class="toctext">Tutorials</span><ul><li><a class="toctext" href="../../tutorials/introduction/">Introduction to Pumas</a></li></ul></li><li><span class="toctext">Basics</span><ul><li><a class="toctext" href="../../basics/overview/">Overview of Pumas</a></li><li><a class="toctext" href="../../basics/models/">Defining NLME Models</a></li><li><a class="toctext" href="../../basics/doses_subjects_populations/">Dosage Regimens, Subjects, and Populations</a></li><li><a class="toctext" href="../../basics/simulation/">Simulation of Pumas Models</a></li><li><a class="toctext" href="../../basics/estimation/">Estimating Parameters of Pumas Models</a></li><li><a class="toctext" href="../../basics/nca/">Noncompartmental Analysis (NCA)</a></li><li><a class="toctext" href="../../basics/faq/">Frequently Asked Questions (FAQ)</a></li></ul></li><li><span class="toctext">Model Components</span><ul><li><a class="toctext" href="../../model_components/domains/">Domains</a></li><li><a class="toctext" href="../../model_components/dosing_control/">Dosing Control Parameters (DCP)</a></li><li><a class="toctext" href="../../model_components/dynamical_types/">Dynamical Problem Types</a></li></ul></li><li><span class="toctext">Diagnostics</span><ul><li class="current"><a class="toctext" href>Simulation and Estimation Diagnostics</a><ul class="internal"><li><a class="toctext" href="#The-infer-Function-1">The <code>infer</code> Function</a></li><li><a class="toctext" href="#The-inspect-Function-1">The <code>inspect</code> Function</a></li><li><a class="toctext" href="#Individual-Diagnostic-Functions-1">Individual Diagnostic Functions</a></li><li><a class="toctext" href="#The-Visual-Predictive-Check-(vpc)-Function-1">The Visual Predictive Check (<code>vpc</code>) Function</a></li></ul></li></ul></li></ul></nav><article id="docs"><header><nav><ul><li>Diagnostics</li><li><a href>Simulation and Estimation Diagnostics</a></li></ul><a class="edit-page" href="https://github.com/PumasAI/PumasDocs.jl/blob/master/docs/src/analysis/diagnostics.md"><span class="fa"></span> Edit on GitHub</a></nav><hr/><div id="topbar"><span>Simulation and Estimation Diagnostics</span><a class="fa fa-bars" href="#"></a></div></header><h1><a class="nav-anchor" id="Simulation-and-Estimation-Diagnostics-1" href="#Simulation-and-Estimation-Diagnostics-1">Simulation and Estimation Diagnostics</a></h1><h2><a class="nav-anchor" id="The-infer-Function-1" href="#The-infer-Function-1">The <code>infer</code> Function</a></h2><h2><a class="nav-anchor" id="The-inspect-Function-1" href="#The-inspect-Function-1">The <code>inspect</code> Function</a></h2><h2><a class="nav-anchor" id="Individual-Diagnostic-Functions-1" href="#Individual-Diagnostic-Functions-1">Individual Diagnostic Functions</a></h2><h3><a class="nav-anchor" id="Population-Residuals-1" href="#Population-Residuals-1">Population Residuals</a></h3><ul><li><code>npde(model, subject, param, randeffs, simulations_count)</code> : Normalized Prediction Distribution Errors</li><li><code>wres(model, subject, param[, rfx])</code> : Weighted Residuals</li><li><code>cwres(model, subject, param[, rfx])</code> : Conditional Weighted Residuals</li><li><code>cwresi(model, subject, param[, rfx])</code> : Conditional Weighted Residuals with Interaction</li></ul><h3><a class="nav-anchor" id="Individual-Residuals-1" href="#Individual-Residuals-1">Individual Residuals</a></h3><ul><li><code>iwres(model, subject, param[, rfx])</code> : Individual Weighted Residuals</li><li><code>icwres(model, subject, param[, rfx])</code> : Individual Conditional Weighted Residuals</li><li><code>icwresi(model, subject, param[, rfx])</code> : Individual Conditional Weighted Residuals with Interaction</li><li><code>eiwres(model, subject, param[, rfx], simulations_count)</code> : Expected Simulation based Individual Weighted Residuals</li></ul><h3><a class="nav-anchor" id="Model-Metrics-1" href="#Model-Metrics-1">Model Metrics</a></h3><ul><li><code>aic(model, population, param, approximation)</code> : Akaike information criterion</li><li><code>bic(model, population, param, approximation)</code> : Bayesian information criterion</li></ul><h3><a class="nav-anchor" id="Random-Effects-1" href="#Random-Effects-1">Random Effects</a></h3><ul><li><code>ηshrinkage(model, population, param, approximation)</code></li><li><code>ϵshrinkage(model, population, param, approximation[, rfx])</code></li></ul><p>If the observations for an individual is informative, η-shrinkage will be low. If, on the other hand, the observations are non-informative, the individual estimates (EBEs) will shrink towards the population mean. Hence, the variance of the EBEs will also shrink and η-shrinkage will be high.</p><p>When data gets sparse the IWRES distribution also shrink towards it’s mean (zero). This is often called overfitting or ϵ-shrinkage.</p><h2><a class="nav-anchor" id="The-Visual-Predictive-Check-(vpc)-Function-1" href="#The-Visual-Predictive-Check-(vpc)-Function-1">The Visual Predictive Check (<code>vpc</code>) Function</a></h2><ul><li><code>vpc(m::PumasModel, data::Population, fixeffs::NamedTuple, reps::Integer;quantiles = [0.05,0.5,0.95], idv = :time, dv = [:dv], stratify_on = nothing)</code></li></ul><p>Computes the quantiles for VPC. The default quantiles are the 5th, 50th and 95th percentiles. Takes in a <code>PumasModel</code>, <code>Population</code>, parameters, and an integer number of repetitions.</p><p>The <code>vpc</code> function returns a <code>VPC</code> object which can then be used for plotting. </p><pre><code class="language-julia">vpc_nonstrat = vpc(m, data, param, 200)
plot(vpc_nonstrat)</code></pre><p>The <code>VPC</code> object stores the quantiles and the simulations which  can be used for recalculating the VPC quantiles with a different combination of arguments.</p><pre><code class="language-julia">vpc_stratwt = vpc(vpc_nonstrat.Simulations, data; stratify_on = [:wt])
plot(vpc_stratwt)</code></pre><p>Note that instead of the model a FittedPumasModel can be also be used.</p><p>Keyword arguments:</p><ul><li><code>quantiles</code>: Takes an array of quantiles to be calculated. The first three indices are used for plotting.</li><li><code>idv</code>: The idv to be used, defaults to time.</li><li><code>dv</code>: Takes an array of symbols of the dvs for which the quantiles are computed.</li><li><code>stratify_on</code>: Takes an array of symbols of covariates which the VPC is stratified on.</li></ul><footer><hr/><a class="previous" href="../../model_components/dynamical_types/"><span class="direction">Previous</span><span class="title">Dynamical Problem Types</span></a></footer></article></body></html>
